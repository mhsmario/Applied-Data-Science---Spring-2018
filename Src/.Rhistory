table(test1$Exterior1st)
test1 <- test1[-c(242,306,103,240,75,280),]
yhat_AIC <- predict(ols_AIC, newdata = test1)
table(train1$Exterior1st)
table(test1$Exterior1st)
test1 <- test1[-c(242,306,103,240,75),]
train1 <- subset(train1, select = -c(Utilities,Street))
test1 <- subset(test1, select = -c(Utilities,Street))
test1 <- test1[-c(242,306,103,240,75),]
test1 <- test1[-c(268),]
yhat_AIC <- predict(ols_AIC, newdata = test1)
table(train1$Exterior1st)
table(test1$Exterior1st)
test1 <- train[1092:1447,]
train1 <- subset(train1, select = -c(Utilities,Street))
test1 <- subset(test1, select = -c(Utilities,Street))
test1 <- test1[-c(242,306,103,240,75),]
test1 <- test1[-c(277),]
table(train1$Exterior1st)
table(test1$Exterior1st)
yhat_AIC <- predict(ols_AIC, newdata = test1)
test1 <- train[1092:1447,]
test1 <- subset(test1, select = -c(Utilities,Street))
yhat_AIC <- predict(ols_AIC, newdata = test1)
test1 <- test1[-c(242),]
yhat_AIC <- predict(ols_AIC, newdata = test1)
test1 <- test1[-c(306),]
yhat_AIC <- predict(ols_AIC, newdata = test1)
test1 <- test1[-c(102,240),]
yhat_AIC <- predict(ols_AIC, newdata = test1)
table(train1$Exterior1st)
table(test1$Exterior1st)
test1 <- test1[-c(102,74),]
yhat_AIC <- predict(ols_AIC, newdata = test1)
test1 <- test1[-c(276),]
yhat_AIC <- predict(ols_AIC, newdata = test1)
table(train1$ExterCond)
table(test1$ExterCond)
test1 <- test1[-c(66),]
yhat_AIC <- predict(ols_AIC, newdata = test1)
SSE_AIC <- mean( (test1$SalePrice - yhat_AIC) ^ 2 )
SSE_AIC
X <- model.matrix(ols)
View(X)
X <- model.matrix(ols)[ ,-74]
X <- model.matrix(ols)[ ,-1]
y <- train1$SalePrice
lasso <- lars(X, y, type = "lasso", trace = FALSE)
test_X <- model.matrix(ols, data = test1)[ ,-1]
yhat_lasso <- predict(lasso, newx = test_X)$fit
dim(yhat_lasso)
table(test1$Exterior2nd)
test1 <- test1[-c(142),]
test_X <- model.matrix(ols, data = test1)[ ,-1]
yhat_lasso <- predict(lasso, newx = test_X)$fit
dim(yhat_lasso)
SSE_lasso <- colMeans( (test1$SalePrice - yhat_lasso) ^ 2 )
min(SSE_lasso)
lar <- lars(X, y, type = "lar", trace = FALSE)
yhat_lar <- predict(lasso, newx = test_X)$fit
dim(yhat_lar)
SSE_lar <- colMeans( (test1$SalePrice - yhat_lar) ^ 2 )
min(SSE_lar) == min(SSE_lasso)
fs <- lars(X, y, type = "forward.stagewise", trace = FALSE)
yhat_fs <- predict(lasso, newx = test_X)$fit
dim(yhat_fs)
SSE_fs <- colMeans( (test1$SalePrice - yhat_fs) ^ 2 )
min(SSE_fs) == min(SSE_lasso)
mod1_train <- lm(SalePrice ~ (.)^2 + OverallQual*YearBuilt - SalePrice, data = train1)
mod1_AIC <- step(mod1_train, trace = FALSE)
names(coef(mod1_AIC))
RF <- randomForest(x=train1[, -74], y=train1$SalePrice, ntree=200,importance=TRUE)
RF
plot(RF)
RF <- randomForest(x=train1[, -74], y=train1$SalePrice, ntree=500,importance=TRUE)
RF
plot(RF)
library(glmnet)
library(purrr)
library(tidyr)
library(readr)
library(corrplot)
library(shiny)
library(dplyr)
library(ggplot2)
library(e1071)
library(glmnet)
library(mice)
library(lattice)
library(VIM)
library(caret)
library(stargazer)
library(gam)
library(flam)
library(bartMachine)
library(tree)
library(ISLR)
library(RColorBrewer)
library(ggfortify)
library(scales)
library(stargazer)
library(rsconnect)
library(knitr)
library(gridExtra)
library(scales)
library(Rmisc)
library(ggrepel)
library(randomForest)
library(psych)
library(purrr)
library(tidyr)
library(ggplot2)
library(readr)
library(dplyr)
library(corrplot)
library(RColorBrewer)
library(shiny)
library(ggfortify)
library(pander)
library(purrr)
library(tidyr)
library(ggplot2)
library(readr)
library(dplyr)
library(corrplot)
library(RColorBrewer)
library(shiny)
library(ggfortify)
library(pander)
library(here)
all <- read.csv("/Users/lizhizicui/Desktop/Final-Project---Applied-Data-Science/Data/Raw//train.csv") # read the data
set.seed(12345)
in_train <- createDataPartition(y = all$SalePrice, p = 3 / 4, list = FALSE) # Split data into training and testing and recombine them
str(in_train)
training <- all[ in_train, ] # three fourth of data go to training
testing Â <- all[-in_train, ]
all <- rbind(training, testing)
na_count <-sapply(all, function(y) sum(length(which(is.na(y)))))
na_count <- data.frame(na_count)
all_test <- all
levels(all_test$PoolQC)
addLevel <- function(x, newlevel=NULL) {
if(is.factor(x)) {
if (is.na(match(newlevel, levels(x))))
return(factor(x, levels=c(levels(x), newlevel)))
}
return(x)
}
all_test$PoolQC <- addLevel(all_test$PoolQC, "None")
all_test$PoolQC <- addLevel(all_test$PoolQC, "Po")
all_test$PoolQC <- addLevel(all_test$PoolQC, "TA")
all_test$PoolQC <- ifelse(is.na(all$PoolQC), "None", paste(all$PoolQC))
Qualities <- c('None' = 0, 'Po' = 1, 'Fa' = 2, 'TA' = 3, 'Gd' = 4, 'Ex' = 5)
all_test$PoolQC<- revalue(all_test$PoolQC, Qualities)
all_test$PoolQC <- as.factor(all_test$PoolQC)
all_test$MiscFeature <- addLevel(all_test$MiscFeature, "None")
all_test$MiscFeature <- ifelse(is.na(all_test$MiscFeature), "None", paste(all_test$MiscFeature))
all_test$MiscFeature <- as.factor(all_test$MiscFeature)
table(all_test$MiscFeature)
all_test$Alley <- addLevel(all_test$Alley, "None")
all_test$Alley <- ifelse(is.na(all_test$Alley), "None", paste(all$Alley))
all_test$Alley <- as.factor(all_test$Alley)
table(all_test$Alley)
all_test$Fence <- addLevel(all_test$Fence, "None")
all_test$Fence <- ifelse(is.na(all$Fence), "None", paste(all_test$Fence))
all_test$Fence <- as.factor(all_test$Fence)
table(all_test$Fence)
all_test$FireplaceQu <- addLevel(all_test$FireplaceQu, "None")
all_test$FireplaceQu <- ifelse(!is.na(all_test$FireplaceQu), paste(all_test$FireplaceQu), "None")
all_test$FireplaceQu <- as.factor(all_test$FireplaceQu)
#GarageYrBlt/GarageFinish/GarageCars/GarageArea/GarageQual/GarageCond
all_test$GarageType <- addLevel(all_test$GarageType, "None")
all_test$GarageType <- ifelse(is.na(all_test$GarageType), "None", paste(all_test$GarageType))
all_test$GarageType <- as.factor(all_test$GarageType)
table(all_test$GarageType)
all_test$GarageYrBlt[is.na(all_test$GarageYrBlt)] <- 'No Garage'
all$GarageYrBlt <- as.numeric(all$GarageYrBlt)
all_test$GarageFinish <- addLevel(all_test$GarageFinish, "None")
all_test$GarageFinish <- ifelse(is.na(all_test$GarageFinish), "None", paste(all_test$GarageFinish))
all_test$GarageFinish <- as.factor(all_test$GarageFinish)
table(all_test$GarageFinish)
all_test$GarageCars[is.na(all_test$GarageCars)] <- 'No Garage'
all_test$GarageCars <- as.factor(all_test$GarageCars)
table(all_test$GarageCars)
all_test$GarageArea[is.na(all_test$GarageArea)] <- 'No Garage'
table(all_test$GarageArea)
all_test$GarageQual <- addLevel(all_test$GarageQual, "None")
all_test$GarageQual <- ifelse(is.na(all_test$GarageQual), "None", paste(all_test$GarageQual))
all_test$GarageQual <- as.factor(all_test$GarageQual)
table(all_test$GarageQual)
all_test$GarageCond <- addLevel(all_test$GarageCond, "None")
all_test$GarageCond <- ifelse(is.na(all_test$GarageCond), "None", paste(all_test$GarageCond))
all_test$GarageCond <- as.factor(all_test$GarageCond)
table(all_test$GarageCond)
#BsmtExposure: Refers to walkout or garden level walls (**smae for BsmtFinType1/BsmtFinSF1/BsmtFinType2/BsmtFinSF2/BsmtUnfSF/BsmtQual)
all_test$BsmtQual <- addLevel(all_test$BsmtQual, "None")
all_test$BsmtQual <- ifelse(is.na(all_test$BsmtQual), "None", paste(all_test$BsmtQual))
all_test$BsmtQual <- as.factor(all_test$BsmtQual)
table(all_test$BsmtQual)
all_test$BsmtExposure <- addLevel(all_test$BsmtExposure, "None")
all_test$BsmtExposure <- ifelse(is.na(all_test$BsmtExposure), "None", paste(all_test$BsmtExposure))
all_test$BsmtExposure <- as.factor(all_test$BsmtExposure)
table(all_test$BsmtExposure)
all_test$BsmtFinType1 <- addLevel(all_test$BsmtFinType1, "None")
all_test$BsmtFinType1 <- ifelse(is.na(all_test$BsmtFinType1), "None", paste(all_test$BsmtFinType1))
all_test$BsmtFinType1 <- as.factor(all_test$BsmtFinType1)
str(all_test$BsmtFinType1)
all_test$BsmtCond <- addLevel(all_test$BsmtCond, "None")
all_test$BsmtCond <- ifelse(is.na(all_test$BsmtCond), "None", paste(all_test$BsmtCond))
all_test$BsmtCond <- as.factor(all_test$BsmtCond)
table(all_test$BsmtCond)
all_test$BsmtFinType2 <- addLevel(all_test$BsmtFinType2, "None")
all_test$BsmtFinType2 <- ifelse(is.na(all_test$BsmtFinType2), "None", paste(all_test$BsmtFinType2))
all_test$BsmtFinType2 <- as.factor(all_test$BsmtFinType2)
table(all_test$BsmtFinType2)
all_test$BsmtFinSF1[is.na(all_test$BsmtFinSF1)] <-0
all_test$BsmtFinSF2[is.na(all_test$BsmtFinSF2)] <-0
all_test$BsmtUnfSF[is.na(all_test$BsmtUnfSF)] <-0
all_test$LotFrontage[is.na(all_test$LotFrontage)] <-0
table(all_test$LotFrontage)
drop.na.columns <- c( "MasVnrType","LotFrontage")
all_test<- all_test[ , !(names(all_test) %in% drop.na.columns)]
all_test <- na.omit(all_test)
# factorize some of the variables
all <- all_test
all$Foundation <- as.factor(all$Foundation)
all$Heating <- as.factor(all$Heating)
all$RoofStyle <- as.factor(all$RoofStyle)
all$RoofMatl <- as.factor(all$RoofMatl)
all$LandContour <- as.factor(all$LandContour)
all$BldgType <- as.factor(all$BldgType)
all$HouseStyle <- as.factor(all$HouseStyle)
all$Condition1 <- as.factor(all$Condition1)
all$Condition2 <- as.factor(all$Condition2)
all$GarageArea <- as.numeric(all$GarageArea)
na_count_test <-sapply(all, function(y) sum(length(which(is.na(y)))))
na_count_test <- data.frame(na_count_test)
write_excel_csv(all, "New_Data.csv")
#Load treated and processed data
New_Data <- read_csv(choose.file() )
#Load treated and processed data
New_Data <- read_csv(file.choose())
distance <- read_csv(file.choose())
#Add the distance data to both Train and Test datasets.
d_train <- left_join(New_Data, distance, by = "Neighborhood")
#d_train1 <- d_train[,-c(73, 75, 7, 74, 57,4, 13, 83,84)]
d_train_noNAs <- na.omit(d_train)
df <- data.frame(tapply(d_train_noNAs$SalePrice, d_train_noNAs$Neighborhood, mean))
library(data.table)
library(forcats)
neighb <- setDT(df, keep.rownames = TRUE)[]
colnames(neighb)[2] <- "mean.price"
#Order values in ascending order.
neighb <- neighb[order(mean.price), ]
neighb$rn <- factor(neighb$rn, levels=unique(as.character(neighb$rn)) )
#Create categories for mean sales price of the neighborhood.
d_train_noNAs$Mean.price <- cut(d_train_noNAs$SalePrice, breaks = c(100,200000,300000, Inf), labels = c("Lower", "Median ", "Higher") )
#plot the results
ggplot(neighb) + geom_col(aes(neighb$rn, y = neighb$mean.price,  fill = df$rn)) +
coord_flip() +
ggtitle("Average Sales Price by Neighborhood") +
ylab("Average Sales Price") + scale_y_continuous(labels = scales::dollar) +
xlab("Neighborhood") + coord_flip()
#Distribution of houses per neighborhood category
pander(table(d_train_noNAs$Neighborhood, d_train_noNAs$Mean.price))
ggplot(data=all[!is.na(all$SalePrice),], aes(x=factor(OverallQual), y=SalePrice))+
geom_boxplot() + labs(x='Overall Quality') +
scale_y_continuous(breaks= seq(0, 800000, by=100000), labels = comma)
summary(all$SalePrice)
hist(all$SalePrice, breaks=seq(30000, 760000, 500),prob=TRUE )
lines(density(all$SalePrice), col="blue", lwd=2)
lines(density(all$SalePrice, adjust=2), lty="dotted")
ggplot(data=all[!is.na(all$SalePrice),], aes(x=factor(OverallQual), y=SalePrice))+
geom_boxplot() + labs(x='Overall Quality') +
scale_y_continuous(breaks= seq(0, 800000, by=100000), labels = comma)
ggplot(data=all[!is.na(all$SalePrice),], aes(x=GrLivArea, y=SalePrice))+
geom_point(col='black') + geom_smooth(method = "lm", se=FALSE, color="blue", aes(group=1)) +
scale_y_continuous(breaks= seq(0, 800000, by=100000), labels = comma)
outlier1 <- all%>% filter(GrLivArea > 4500)
outlier1$Id
all[c(524, 1299, 2550), c('SalePrice', 'GrLivArea', 'OverallQual')]
summary(all$GarageCars)
ggplot(data=all[!is.na(all$SalePrice),], aes(x=factor(GarageCars), y=SalePrice))+
geom_boxplot() + labs(x='Size of Garage/car') +
scale_y_continuous(breaks= seq(0, 800000, by=100000), labels = comma)
outlier2 <- all %>%
filter(GarageCars == 3)%>%
filter(SalePrice > 700000)
outlier2$Id
all[c(524, 1299, 692, 1183), c('SalePrice', 'GrLivArea', 'OverallQual','GarageCars')]
ggplot(data=all[!is.na(all$SalePrice),], aes(x=BsmtFinSF1, y=SalePrice))+
geom_point(col='black') + geom_smooth(method = "lm", se=FALSE, color="blue", aes(group=1))+
scale_x_continuous(limits = c(100 ,2500))
df <- data.frame(tapply(train$SalePrice, train$Neighborhood, mean))
library(data.table)
setDT(df, keep.rownames = TRUE)[]
colnames(df) <- c('Neighborhood','Average SalePrice')
ggplot(df, aes(x = Neighborhood, y= `Average SalePrice`)) +
geom_col(aes(fill = df$Neighborhood))+
geom_hline(yintercept=mean(train$SalePrice), linetype="dashed", color = "red")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
df <- data.frame(tapply(all$SalePrice, all$Neighborhood, mean))
library(data.table)
setDT(df, keep.rownames = TRUE)[]
colnames(df) <- c('Neighborhood','Average SalePrice')
ggplot(df, aes(x = Neighborhood, y= `Average SalePrice`)) +
geom_col(aes(fill = df$Neighborhood))+
geom_hline(yintercept=mean(train$SalePrice), linetype="dashed", color = "red")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
df <- data.frame(tapply(all$SalePrice, all$Neighborhood, mean))
library(data.table)
setDT(df, keep.rownames = TRUE)[]
colnames(df) <- c('Neighborhood','Average SalePrice')
ggplot(df, aes(x = Neighborhood, y= `Average SalePrice`)) +
geom_col(aes(fill = df$Neighborhood))+
geom_hline(yintercept=mean(train$SalePrice), linetype="dashed", color = "red")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
df <- data.frame(tapply(all$SalePrice, all$Neighborhood, mean))
library(data.table)
setDT(df, keep.rownames = TRUE)[]
colnames(df) <- c('Neighborhood','Average SalePrice')
ggplot(df, aes(x = Neighborhood, y= `Average SalePrice`)) +
geom_col(aes(fill = df$Neighborhood))+
geom_hline(yintercept=mean(all$SalePrice), linetype="dashed", color = "red")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=train, aes(x=(Neighborhood))) +
geom_histogram(stat='count')+
geom_label(stat = "count", aes(label = ..count.., y = ..count..), size=3)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
df <- data.frame(tapply(all$SalePrice, all$Neighborhood, mean))
library(data.table)
setDT(df, keep.rownames = TRUE)[]
colnames(df) <- c('Neighborhood','Average SalePrice')
ggplot(df, aes(x = Neighborhood, y= `Average SalePrice`)) +
geom_col(aes(fill = df$Neighborhood))+
geom_hline(yintercept=mean(all$SalePrice), linetype="dashed", color = "red")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=df, aes(x=(Neighborhood))) +
geom_histogram(stat='count')+
geom_label(stat = "count", aes(label = ..count.., y = ..count..), size=3)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
df <- data.frame(tapply(all$SalePrice, all$Neighborhood, mean))
library(data.table)
setDT(df, keep.rownames = TRUE)[]
colnames(df) <- c('Neighborhood','Average SalePrice')
ggplot(df, aes(x = Neighborhood, y= `Average SalePrice`)) +
geom_col(aes(fill = df$Neighborhood))+
geom_hline(yintercept=mean(all$SalePrice), linetype="dashed", color = "red")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=all, aes(x=(Neighborhood))) +
geom_histogram(stat='count')+
geom_label(stat = "count", aes(label = ..count.., y = ..count..), size=3)+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data=all[!is.na(all$SalePrice),], aes(x=YearBuilt, y=SalePrice))+
geom_point(col='black') + geom_smooth(method = "lm", se=FALSE, color="blue", aes(group=1))+
scale_x_continuous(limits = c(1860 ,2020))
#OLS Model 1 - very naive considering only the variab
# naive.model <- lm(SalePrice ~ Car.miles + OverallQual + OverallCond + Mean.price  , data = d_train_noNAs)
# summary(naive.model)
print("Model 1.0: Car.Time.min")
naive.model0 <- lm(SalePrice ~ Car.Time.min + OverallQual +OverallCond + Mean.price  , data = d_train_noNAs)
summary(naive.model0)
# naive.model1 <- lm(SalePrice ~ Walk.miles + OverallQual +OverallCond + Mean.price  , data = d_train_noNAs)
# summary(naive.model1)
naive.model1.1 <- lm(SalePrice ~ Walk.time.min + OverallQual +OverallCond + Mean.price  , data = d_train_noNAs)
summary(naive.model1.1)
naive.model2 <- lm(SalePrice ~ Bus.time.min + OverallQual +OverallCond + Mean.price  , data = d_train_noNAs)
summary(naive.model2)
ggplot(data=all[!is.na(all$SalePrice),], aes(x=factor(OverallCond), y=SalePrice))+
geom_boxplot() + labs(x='Overall Quality') +
scale_y_continuous(breaks= seq(0, 800000, by=100000), labels = comma)
ggplot(data=all[!is.na(all$SalePrice),], aes(x=factor(OverallCond), y=SalePrice))+
geom_boxplot() + labs(x='Overall Condition')
ggplot(data=all[!is.na(all$SalePrice),], aes(x=factor(OverallCond), y=SalePrice))+
geom_boxplot() + labs(x='Overall Condition')+
scale_y_continuous(breaks= seq(0, 800000, by=100000), labels = comma)
ggplot(data=all[!is.na(all$SalePrice),], aes(x=factor(OverallCond), y=SalePrice))+
geom_boxplot() + labs(x='Overall Condition')+
scale_y_continuous(breaks= seq(0, 800000, by=100000), labels = comma)
m2.train <- lm(SalePrice ~ Bus.time.min + ., data = d_train_noNAs)
#Show only relevant coefficients
a2Pval <- summary(m2.train)$coefficients[1:2, 1:4]
a2Pval
set.seed(12345) # = Seed for replication
#d_train_noNAs <- na.omit(d_train)
x <- model.matrix(SalePrice ~ ., data = d_train_noNAs)[ ,-79]
y <- d_train_noNAs$SalePrice
### We then fit a Lasso regression model (alpha = 1)
fit.lasso <- glmnet(x, y, alpha = 1, family = "gaussian")
plot(fit.lasso, xvar = "lambda", label = TRUE)
### Now we cross-validate
cv.lasso <- cv.glmnet(x, y)
#cv.lasso$lambda.min
#cv.lasso$lambda.1se
#coef(cv.lasso, s = "lambda.min")
plot(cv.lasso)
set.seed(12345) # = Seed for replication
### Extract coefficients corresponding to lambda.min (minimum mean cross-validated error)
myCoefs <- coef(cv.lasso, s = "lambda.1se")
# print(as.matrix(min.coef))
myLasso.Results <- data.frame(
features = myCoefs@Dimnames[[1]][ which(myCoefs != 0 ) ], #intercept included
coefs    = myCoefs              [ which(myCoefs != 0 ) ]  #intercept included
)
# myLasso.Results$level.coefs <- cut(myLasso.Results$coefs, 5, labels = c("lowest","low", "med", "high", "highest"))
#
# table(myLasso.Results$level.coefs)
#
# summary(myLasso.Results$coefs)
#
# ggplot(myLasso.Results) + geom_bar(aes(myLasso.Results$level.coefs, fill = myLasso.Results$level.coefs)) + coord_flip()
pander(myLasso.Results)
#pander(filter(myLasso.Results, level.coefs != "low" ))
myLasso.Results <- myLasso.Results[-1,]
var.lasso <- myLasso.Results[,1]
var.lasso
m4.train <- lm(SalePrice ~ Bus.time.min + MSZoning + OverallQual + YearBuilt +  TotalBsmtSF + X1stFlrSF + GrLivArea + Fireplaces + GarageCars + Mean.price
, data = d_train_noNAs)
summary(m4.train)
# Neighborhood
train <- read.csv("/Users/lizhizicui/Desktop/Final-Project---Applied-Data-Science/Src/New_Data.csv")
# Neighborhood
train <- read.csv(file.choose())
# Neighborhood
train <- read.csv(file.choose())
# Neighborhood
train <- read.csv(file.choose())
train <- na.omit(train)
train$GarageYrBlt <- as.integer(train$GarageYrBlt)
all_numVar <- train[, numericVars]
# Neighborhood
train <- read.csv(file.choose())
train <- na.omit(train)
train$GarageYrBlt <- as.integer(train$GarageYrBlt)
all_numVar <- train[, numericVars]
numericVars <- which(sapply(train, is.numeric)) #index vector numeric variables
factorVars <- which(sapply(train, is.factor)) #index vector factor variables
all_numVar <- train[, numericVars]
cor_numVar <- cor(all_numVar, use="pairwise.complete.obs")
cor_sorted <- as.matrix(sort(cor_numVar[,'SalePrice'], decreasing = TRUE))
#select only high corelations
CorHigh <- names(which(apply(cor_sorted, 1, function(x) abs(x)>0.5)))
cor_numVar <- cor_numVar[CorHigh, CorHigh]
corrplot.mixed(cor_numVar, tl.col="black", tl.pos = "lt", tl.cex = 0.7,cl.cex = .7, number.cex=.7)
dropVars <- c('YearRemodAdd', 'GarageArea', 'TotalBsmtSF', 'TotalRmsAbvGrd')
train <- train[,!(names(train) %in% dropVars)]
train <- train[-c(524, 1299, 2550),]
write_csv(train, 'Final_data.csv')
train <- read.csv('Final_data.csv')
cat('There are', length(numericVars), 'numeric variables, and', length(factorVars), 'categoric variables')
set.seed(123)
quick_RF <- randomForest(x=train[, -76], y=train$SalePrice, ntree=200,importance=TRUE)
imp_RF <- importance(quick_RF)
imp_DF <- data.frame(Variables = row.names(imp_RF), MSE = imp_RF[,1])
imp_DF <- imp_DF[order(imp_DF$MSE, decreasing = TRUE),]
ggplot(imp_DF[1:20,], aes(x=reorder(Variables, MSE), y=MSE, fill=MSE)) + geom_bar(stat = 'identity') + labs(x = 'Variables', y= '% increase MSE if variable is randomly permuted') + coord_flip() + theme(legend.position="none")
train$Mean.price <- cut(train$SalePrice, breaks = c(100,200000,300000, Inf), labels = c("Lower", "Median ", "Higher") )
a <- train%>%
filter(Mean.price == 'Higher')
train1 <- train[1:1092,]
test1 <- train[1092:1447,]
ols <- lm(Mean.price ~ GarageCars+ BsmtFinSF1+ OverallQual+ Neighborhood + GrLivArea + OverallQual*YearBuilt ,data = train1)
summary(ols)$adj.r.squared
y_hat_ols <- predict(ols, newdata = test1)
y_hat_ols
summary(y_hat_ols)
z_ols <- as.integer(y_hat_ols > 1)
z_ols
table(test1$Mean.price, z_ols)
# step function
train1 <- subset(train1, select = -c(Utilities,Street))
test1 <- subset(test1, select = -c(Utilities,Street))
test1 <- test1[!test1$Id == 1004,]
test1 <- test1[!test1$Id == 1299,]
test1 <- test1[!test1$Id == 1001,]
test1 <- test1[!test1$Id == 1188,]
test1 <- test1[!test1$Id == 411,]
test1 <- test1[!test1$Id == 251,]
test1 <- test1[!test1$Id == 596,]
library(VGAM)
# with interaction term
fit_log <- vglm(Mean.price ~ GarageCars+ BsmtFinSF1+ OverallQual+ Neighborhood + GrLivArea, family=multinomial, data=train1)
# summarize the fit
summary(fit_log)
# make predictions
probabilities <- predict(fit_log, newdata = test1, type="response")
predictions <- apply(probabilities, 1, which.max)
predictions[which(predictions=="Lower")] <- levels(test1$Mean.price)[1]
predictions[which(predictions=="Median")] <- levels(test1$Mean.price)[2]
predictions[which(predictions=="Higher")] <- levels(test1$Mean.price)[3]
# summarize accuracy
tbl_log <- table(predictions, test1$Mean.price)
tbl_log
sum(diag(tbl_log))/sum(tbl_log)
library(e1071)
classifier = svm(formula = Mean.price ~ . ,data = train1[,-74] ,
type = 'C-classification',
kernel = 'linear')
help("svm")
# Predicting the Test set results
y_pred = predict(classifier, newdata = test1[,-c(74,75)])
# Making the Confusion Matrix
cm = table(test1[,75], y_pred)
cm
sum(diag(cm))/sum(cm)
RF <- randomForest(x=train1[, (names(train1) %in% c("OverallQual","BsmtFinSF1","GarageCars",'Neighborhood','GrLivArea'))], y=train1$Mean.price, ntree=150,importance=TRUE)
y_pred = predict(RF, newdata = test1[-c(74,75)])
# Making the Confusion Matrix
rf_cm = table(test1[,75], y_pred)
rf_cm
sum(diag(rf_cm))/sum(rf_cm)
plot(RF)
